<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Quay Repositories :: Red Hat Quay Workshop</title>
    <link rel="canonical" href="https://olleb.com/quay-workshop/quay-repos.html">
    <link rel="prev" href="quay-orgs.html">
    <link rel="next" href="quay-mirror.html">
    <meta name="generator" content="Antora 3.0.3">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://olleb.com/quay-workshop">Red Hat Quay Workshop</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kafka-tutorial/" target="_blank">Kafka</a>
            <a class="navbar-item" href="https://devsecops-workshop.github.io/" target="_blank">DevSecOps</a>
            <a class="navbar-item" href="https://acidonper.github.io/redhat-workshop-cicd-gitops/redhat-workshop-cicd-gitops/" target="_blank">CI/CD & GitOps</a>
            <a class="navbar-item" href="https://atarazana.github.io/gramola-gitops-guide/gramola-gitops-guide/" target="_blank">Gramola GitOps Guide</a>
            <a class="navbar-item" href="https://luisarizmendi.github.io/tutorial-secure-onboarding/" target="_blank">Secure Edge device onboarding with RHEL and FDO</a>
            <a class="navbar-item" href="https://xbryan1.github.io/rhte-2023-acm-docs/" target="_blank">Multicluster Application Deployment with Advanced Cluster Management and GitOps</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="v3.7">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="setup.html">1. Environment Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#tools">1.1. Container Management Tools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="setup.html#quay">1.2. Red Hat Quay Prerequisites</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="setup.html#odf">1.2.1. ODF operator</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="setup.html#storage">1.2.2. Creating the standalone object gateway</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="setup.html#quayoperator">1.2.3. Installing Quay operator</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="setup.html#quayinstance">1.2.4. Deploying Quay</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="setup.html#exportenvvar">1.2.5. Export environment variables</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">2. Red Hat Quay</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-orgs.html">2.1 Users and Organizations</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-orgs.html#useraccounts">2.1.1 Creating user accounts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-orgs.html#orgaccounts">2.1.2 Creating organization accounts</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-repos.html">2.2 Quay Repositories</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#imagerepo">2.2.1 Creating an image repository</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#push">2.2.2 Push (and tag) an image into the repository</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#imglayers">2.2.3 Inspecting image layers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#pull">2.2.4 Pull an image from the repository</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#rollback">2.2.5 Image rollback</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#expiration">2.2.6 Image expiration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-mirror.html">2.3 Quay Repository Mirroring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-mirror.html#imagerepo">2.3.1 Creating a repository to mirror from</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="quay-mirror.html#usage">2.3.1.2 Repository usage logs, tags and tag history</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-repo-notifications.html">2.4 Quay Repository Notifications</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-repo-notifications.html#pushnotif">2.4.1 Creating a push to repository event notification</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-oci.html">2.5 Quay OCI-based Artifacts Repository</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-oci.html#allowed">2.5.1 Configuring allowed OCI artifact types</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-oci.html#helm">2.5.2 Helm charts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-oci.html#signed">2.5.3 Signed container images</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="quay-oci.html#cosign">2.5.3.1 Signed container images with cosign</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="quay-oci.html#signpgp">2.5.3.2 Signed container images with PGP (RFC4880)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-oci.html#encrypted">2.5.4 Encrypted container images</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="quay-oci.html#jwe">2.5.4.1 Encrypted container images with JSON Web Encryption (JWE) (RFC7516)</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="quay-oci.html#pgp">2.5.4.2 Encrypted container images with PGP (RFC4880)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-clair.html">2.6 Clair Security Scanning</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-clair.html#cve">2.6.1 Explore the vulnerability data (CVE&#8217;s)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="quay-clair.html#secscan">2.6.1.1 Security scan</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="quay-clair.html#packages">2.6.1.2 Packages</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-cso.html">2.7 Quay Container Security Operator (CSO)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-cso.html#install">2.7.1 Installing the Quay CSO Operator</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-cso.html#vulncheck">2.7.2 Checking the image vulnerabilities through the OpenShift web console</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-obs.html">2.8 Quay Observability</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Red Hat Quay Workshop</a></li>
    <li>2. Red Hat Quay</li>
    <li><a href="quay-repos.html">2.2 Quay Repositories</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">v3.7</button>
  <div class="version-menu">
    <a class="version" href="../quay-repos.html">main</a>
    <a class="version is-current" href="quay-repos.html">v3.7</a>
  </div>
</div>
  <div style="padding: 0 0.5rem 0 0.75rem;"><a href="https://www.linkedin.com/in/angelolle/" target="_blank" rel="noopener noreferrer"> Àngel Ollé Blázquez | Specialist Solution Architect </a></div>
</div>
 
  <div class="content">
<article class="doc">
<h1 class="page">Quay Repositories</h1>
<div class="sect1">
<h2 id="imagerepo"><a class="anchor" href="#imagerepo"></a>Creating an image repository</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Click <code>Create New Repository</code>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/create-repo.png" alt="create repo">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the organization in the drop down list, name the repository <code>kafka</code> and set <code>Public</code> visibility.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/repo-config.png" alt="repo config">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Click <code>Create Public Repository</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="push"><a class="anchor" href="#push"></a>Push (and tag) an image into the repository</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Pull an image from the public registry.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman pull quay.io/strimzi/kafka:latest-kafka-3.1.0</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Tag the image.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman tag quay.io/strimzi/kafka:latest-kafka-3.1.0 ${QUAY_HOSTNAME}/olleb/kafka:3.1.0</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Sign into our Quay repository (if we are not already signed in).</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman login ${QUAY_HOSTNAME}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Push the image to Quay repository.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman push ${QUAY_HOSTNAME}/olleb/kafka:3.1.0</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Check that the image has been pushed into our Quay repository.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/image-pushed.png" alt="image pushed">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="imglayers"><a class="anchor" href="#imglayers"></a>Inspecting image layers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Navigate to the <code>olleb/kafka</code> repository.</p>
</li>
<li>
<p>Click the <code>Tags</code> icon.</p>
</li>
<li>
<p>Click the <code>SHA256</code> value under <code>MANIFEST</code> of the <code>3.1.0</code> tag to see the layers dashboard.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/image-pushed.png" alt="image pushed">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/img-layers.png" alt="img layers">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pull"><a class="anchor" href="#pull"></a>Pull an image from the repository</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>From Quay dashboard, click the <code>olleb/kafka</code> repository.</p>
</li>
<li>
<p>Click <code>Tags</code>.</p>
</li>
<li>
<p>On any of the tags, click the <code>Fetch Tag</code> icon.</p>
</li>
<li>
<p>Select <code>Docker Pull (by tag)</code> from the <code>Image Format</code> drop down and click the <code>Copy Command</code> button.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/fetchtag.png" alt="fetchtag">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Switch to a terminal, paste and execute the command on it. Docker or podman is required. If we&#8217;re using podman, we have to replace the <code>docker</code> with <code>podman</code> before execute the command.
As we created the repository as <code>Public</code>, login is not required to pull.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rollback"><a class="anchor" href="#rollback"></a>Image rollback</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quay provide us a way for reviewing the history of tags and revert those to a previous image.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new image repository as already explained. I created the <code>olleb/rollback</code> repository.</p>
</li>
<li>
<p>Build an image, tag it and push it.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "FROM scratch" &gt; Containerfile.rbk
podman build . -t rollback:1.0 -f Containerfile.rbk

podman tag localhost/rollback:1.0 ${QUAY_HOSTNAME}/olleb/rollback:latest
podman push ${QUAY_HOSTNAME}/olleb/rollback:latest</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Verify that the image has been pushed into Quay repository. Check also the manifest digest and the layers.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/rblatest1.png" alt="rblatest1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/rblayers1.png" alt="rblayers1">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add a new layer, build, tag it with the same remote tag and push the new image to <strong>overwrite</strong> the old one.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "LABEL org.opencontainers.image.authors=<a href="mailto:angel@olleb.com">angel@olleb.com</a>" &gt;&gt; Containerfile.rbk
podman build . -t rollback:2.0 -f Containerfile.rbk

podman tag localhost/rollback:2.0 ${QUAY_HOSTNAME}/olleb/rollback:latest
podman push ${QUAY_HOSTNAME}/olleb/rollback:latest</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Verify that the image has been pushed into Quay repository. Check also the manifest digest and the layers. Observe that the manifest digest and the layers are different than the previous image.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/rblatest2.png" alt="rblatest2">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/rblayers2.png" alt="rblayers2">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Rollback the image to the previous one. Click <code>Tag History</code>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/taghistory.png" alt="taghistory">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Click <code>Revert to &#8230;&#8203;</code>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/revert.png" alt="revert">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Click <code>Restore Tag</code>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/restoretag.png" alt="restoretag">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Verify that the image has been restored with the previous one.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/restored.png" alt="restored">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="expiration"><a class="anchor" href="#expiration"></a>Image expiration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Image tags can be configured to expire from Quay on a time and date.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new image repository as already explained. I created the <code>olleb/expiration</code> repository.</p>
</li>
<li>
<p>Build a <code>1.0</code> image, tag it and push it.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "FROM scratch" &gt; Containerfile.exp
podman build . -t exp:1.0 -f Containerfile.exp

podman tag localhost/exp:1.0 ${QUAY_HOSTNAME}/olleb/expiration:1.0
podman push ${QUAY_HOSTNAME}/olleb/expiration:1.0</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Build a new <code>2.0</code> image, tag it also as <code>latest</code> and push both tags. On that image version, we are going to include the label <code>quay.expires-after</code> with a value of <code>5m</code> in our <code>Containerfile</code>; Quay will automatically expire those tags after the indicated time.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "LABEL org.opencontainers.image.authors=<a href="mailto:angel@olleb.com">angel@olleb.com</a>" &gt;&gt; Containerfile.exp
echo "LABEL quay.expires-after=5m" &gt;&gt; Containerfile.exp
podman build . -t exp:2.0 -f Containerfile.exp

podman tag localhost/exp:2.0 ${QUAY_HOSTNAME}/olleb/expiration:2.0
podman push ${QUAY_HOSTNAME}/olleb/expiration:2.0

podman tag localhost/exp:2.0 ${QUAY_HOSTNAME}/olleb/expiration:latest
podman push ${QUAY_HOSTNAME}/olleb/expiration:latest</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We should have two images and three tags in our repository. Two of them marked as expiring soon.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/exp1.png" alt="exp1">
</div>
</div>
<div class="paragraph">
<p>After a while, both tags will be removed automatically.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/taghistoryautodeleted.png" alt="taghistoryautodeleted">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the <code>1.0</code> tag, in the <code>Actions</code> drop down list select <code>Change Tags Expiration</code>. Set the desired <code>Expiration Date</code>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/expirationdatetag.png" alt="expirationdatetag">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Alternatively, the expiration also can be set through the <code>Options</code> icon → <code>Change Expiration</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the tag is about to expire a message is shown:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/abouttoexpire.png" alt="abouttoexpire">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
by default, the minimum expiration time is one hour and the maximum is 104 weeks (2 years aprox.); at the time of this writing. If we want to allow earlier/later minimum expiration, the <code>LABELED_EXPIRATION_MINIMUM</code> property can be set to a different time value like <code>60s</code> (seconds), <code>5m</code> (minutes), <code>24h</code> (hours), <code>7d</code> (days), <code>2w</code> (weeks). The configuration has to be put in the <code>Config Bundle Secret</code> of our registry instance. An example of how to do it is explained in the following section <a href="quay-oci.html#allowed" class="xref page">2.5.1 Configuring allowed OCI artifact types</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the tag expires, is deleted automatically.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/tagexpireddeleted.png" alt="tagexpireddeleted">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Note that even though the tag is deleted, we can still restore the image. The reason is, when a tag is deleted, and there are no other tags pointing on the same image, the image is garbage collected not before the default value, which is 14 days (<code>2w</code>). Quay has a gc worker enabled by default which runs periodically and removes the expired stuff when the configured <strong>Time Machine</strong> amount of time passed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As we stored the image inside <code>olleb</code> organization, we can check that value browsing to <code>/organization/olleb?tab=settings</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/orgexptime.png" alt="orgexptime">
</div>
</div>
<div class="paragraph">
<p>If the image stored is under the user account instead on an organization, the value is under user settings.</p>
</div>
<div class="paragraph">
<p>The Time Machine amount time can be modified changing the value of <code>TAG_EXPIRATION_OPTIONS</code> array property; a default expiration value also exists which is <code>DEFAULT_TAG_EXPIRATION</code>, <code>TAG_EXPIRATION_OPTIONS</code> <strong>must</strong> include that value in the list. As before, an example of how to do it is explained in the following section <a href="quay-oci.html#allowed" class="xref page">2.5.1 Configuring allowed OCI artifact types</a>.</p>
</div>
<div class="paragraph">
<p>For example, with the following custom configuration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/expcfg.png" alt="expcfg">
</div>
</div>
<div class="paragraph">
<p>we will see:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/customtm.png" alt="customtm">
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="quay-orgs.html">2.1 Users and Organizations</a></span>
  <span class="next"><a href="quay-mirror.html">2.3 Quay Repository Mirroring</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
