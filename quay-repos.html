<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Repositories :: Red Hat Quay Workshop</title>
    <link rel="canonical" href="https://olleb.com/quay-workshop/quay-repos.html">
    <link rel="prev" href="quay-orgs.html">
    <link rel="next" href="quay-mirror.html">
    <meta name="generator" content="Antora 3.0.3">
    <link rel="stylesheet" href="./_/css/site.css">
<link rel="icon" href="./_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="./_/img/RHDLogo.svg" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://olleb.com/quay-workshop">Red Hat Quay Workshop</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kafka-tutorial/" target="_blank">Kafka</a>
            <a class="navbar-item" href="https://devsecops-workshop.github.io/" target="_blank">DevSecOps</a>
            <a class="navbar-item" href="https://acidonper.github.io/redhat-workshop-cicd-gitops/redhat-workshop-cicd-gitops/" target="_blank">CI/CD & GitOps</a>
            <a class="navbar-item" href="https://atarazana.github.io/gramola-gitops-guide/gramola-gitops-guide/" target="_blank">Gramola GitOps Guide</a>
            <a class="navbar-item" href="https://luisarizmendi.github.io/tutorial-secure-onboarding/" target="_blank">Secure Edge device onboarding with RHEL and FDO</a>
            <a class="navbar-item" href="https://xbryan1.github.io/rhte-2023-acm-docs/" target="_blank">Multicluster Application Deployment with Advanced Cluster Management and GitOps</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/java-inner-loop-dev-guide/java-inner-loop-dev-guide/index.html" target="_blank">Java Inner Loop Dev Guide</a>
            <a class="navbar-item" href="https://atarazana.github.io/kitchensink-guide/" target="_blank">Deploying JBoss EAP applications on OpenShift</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="setup.html">Prerequisites</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#odf">ODF Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#storage">Creating the ODF Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#quayoperator">Installing the Quay Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#quayinstance">Deploying Quay</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#exportenvvar">Exporting Environment Variables</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="setup.html#trustedca">Adding the Quay Certificate as a Trusted CA in OCP (Optional)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-orgs.html">Users and Organizations</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-orgs.html#useraccounts">Creating User Accounts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-orgs.html#orgaccounts">Creating Organization Accounts</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-repos.html">Repositories</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#imagerepo">Creating an Image Repository</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#push">Pushing and Tagging an Image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#imglayers">Inspecting Image Layers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#pull">Pulling an Image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#rollback">Rolling Back an Image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#expiration">Image Expiration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-mirror.html">Repository Mirroring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-mirror.html#imagerepo">Creating a Mirrored Repository</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-mirror.html#usage">Repository Usage Logs, Tags, and Tag History</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-repo-notifications.html">Repository Notifications</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-repo-notifications.html#pushnotif">Creating a Push-to-Repository Event Notification</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-oci.html">OCI-Based Artifacts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-oci.html#helm">Working with Helm Charts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-oci.html#signed">Signed Container Images</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-oci.html#cosign">Signing Container Images with Cosign</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-oci.html#signpgp">Signing Container Images with PGP (RFC4880)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-oci.html#encrypted">Encrypted Container Images</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-oci.html#jwe">Encrypting Container Images with JSON Web Encryption (JWE) (RFC7516)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-oci.html#pgp">Encrypting Container Images with PGP (RFC4880)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-clair.html">Security Scanning (Clair)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-clair.html#cve">Exploring Vulnerability Data (CVEs)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-clair.html#secscan">Performing a Security Scan</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="quay-clair.html#packages">Viewing Packages</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-cso.html">Container Security Operator (CSO)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-cso.html#install">Installing the Quay CSO Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-cso.html#vulncheck">Checking Image Vulnerabilities from the OpenShift Web Console</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="quay-obs.html">Observability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="quay-troubleshooting.html">Troubleshooting and Tips</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-troubleshooting.html#tls">TLS and Insecure Registry Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-troubleshooting.html#cosign">cosign and Registry Trust Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quay-troubleshooting.html#gpg">GPG Key Cleanup</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Red Hat Quay Workshop</a></li>
    <li><a href="quay-repos.html">Repositories</a></li>
  </ul>
</nav>
  <div style="padding: 0 0.5rem 0 0.75rem;"><a href="https://olleb.com" target="_blank" rel="noopener noreferrer"> © 2025 - Àngel Ollé Blázquez</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Repositories</h1>
<div class="sect1">
<h2 id="imagerepo"><a class="anchor" href="#imagerepo"></a>Creating an Image Repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On the main Quay landing page:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Click the <code>Create New Repository</code> button.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/create-repo.png" alt="create repo">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the organization from the drop-down list, name the repository <code>kafka</code>, and set the visibility to <code>Public</code>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/repo-config.png" alt="repo config">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Click <code>Create Public Repository</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="push"><a class="anchor" href="#push"></a>Pushing and Tagging an Image</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Pull an image from the public registry by running the <code>podman pull</code> command followed by the image name.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman pull quay.io/strimzi/kafka:latest-kafka-4.0.0</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Tag the image with a name and version number using the <code>podman tag</code> command.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman tag quay.io/strimzi/kafka:latest-kafka-4.0.0 ${QUAY_HOSTNAME}/olleb/kafka:4.0.0</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Sign in to your Quay repository using your account credentials, if you are not already signed in.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman login ${QUAY_HOSTNAME}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Push the image to the Quay repository using the <code>podman push</code> command.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman push ${QUAY_HOSTNAME}/olleb/kafka:4.0.0</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Verify that the image has been successfully pushed to your Quay repository by confirming that the image is listed.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/image-pushed.png" alt="image pushed">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="imglayers"><a class="anchor" href="#imglayers"></a>Inspecting Image Layers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Navigate to the <code>olleb/kafka</code> repository.</p>
</li>
<li>
<p>Click the <code>Tags</code> icon.</p>
</li>
<li>
<p>Under the <code>MANIFEST</code> section of the <code>4.0.0</code> tag, click the <code>SHA256</code> value to open the image layers dashboard.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/image-pushed2.png" alt="image pushed2">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/img-layers.png" alt="img layers">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pull"><a class="anchor" href="#pull"></a>Pulling an Image</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>From the Quay dashboard, locate and select the <code>olleb/kafka</code> repository.</p>
</li>
<li>
<p>Click the <code>Tags</code> tab.</p>
</li>
<li>
<p>Select any of the repository’s tags and click the <code>Fetch Tag</code> icon.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/fetchtagpre.png" alt="fetchtagpre">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>From the <strong>Image Format</strong> drop-down menu, select <code>Podman Pull (by tag)</code> and click the <code>Copy Command</code> button.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/fetchtag.png" alt="fetchtag">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Switch to a terminal, paste the command you copied from the Quay UI, and execute it.
Ensure that <code>Podman</code> is installed on your system. Since the repository was created as <code>Public</code>, no login is required to pull the image.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rollback"><a class="anchor" href="#rollback"></a>Rolling Back an Image</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quay provides a convenient way to review the history of tags associated with an image repository and to roll back to a previous version when needed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new image repository as previously explained. In this case, create a public repository named <code>olleb/rollback</code> on Quay.</p>
</li>
<li>
<p>Build an image, tag it, and push it.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "FROM scratch" &gt; Containerfile.rbk
podman build . -t rollback:1.0 -f Containerfile.rbk

podman tag localhost/rollback:1.0 ${QUAY_HOSTNAME}/olleb/rollback:latest
podman push ${QUAY_HOSTNAME}/olleb/rollback:latest</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Verify that the image has been pushed to the Quay repository. Also, check the manifest digest and the layers.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/rblatest1.png" alt="rblatest1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/rblayers1.png" alt="rblayers1">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add a new layer to the <code>Containerfile</code>, rebuild the image, and <strong>overwrite</strong> the previous one by tagging and pushing it with the same remote tag.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "LABEL org.opencontainers.image.authors=<a href="mailto:angel@olleb.com">angel@olleb.com</a>" &gt;&gt; Containerfile.rbk
podman build . -t rollback:2.0 -f Containerfile.rbk

podman tag localhost/rollback:2.0 ${QUAY_HOSTNAME}/olleb/rollback:latest
podman push ${QUAY_HOSTNAME}/olleb/rollback:latest</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Verify that the new image has been pushed to the Quay repository, and check its manifest digest and layers in the Quay UI.
You should observe that the manifest digest and layers differ from the previous image.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/rblatest2.png" alt="rblatest2">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/rblayers2.png" alt="rblayers2">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To roll back the image to the previous version, navigate to the Quay UI and click the <code>Tag History</code> option for the repository.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/tagh.png" alt="tagh">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>From there, select the tag of the previous image you want to restore, and click <code>Revert to &#8230;&#8203;</code>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/revert.png" alt="revert">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Click the <code>Restore Tag</code> button. This will restore the tag to reference the previous image.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/restoretag.png" alt="restoretag">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To verify that the rollback was successful, go to the <code>Tag History</code> section in the Quay UI and confirm that the restored tag has the same manifest digest and layers as the previous image.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/restored.png" alt="restored">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="expiration"><a class="anchor" href="#expiration"></a>Image Expiration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure an image tag to expire in Quay at a specific time or date, follow these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new image repository as previously explained. In this example, create a public repository named <code>olleb/expiration</code>.</p>
</li>
<li>
<p>Build a <code>1.0</code> image, tag it, and push it to the <code>olleb/expiration</code> repository.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "FROM scratch" &gt; Containerfile.exp
podman build . -t exp:1.0 -f Containerfile.exp

podman tag localhost/exp:1.0 ${QUAY_HOSTNAME}/olleb/expiration:1.0
podman push ${QUAY_HOSTNAME}/olleb/expiration:1.0</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The label <code>quay.expires-after</code> is used to specify the expiration time for a tag.
The value can be defined in several formats, including a specific date and time, a relative time offset from image creation, or a relative time offset from tag creation.
In this example, we use a relative time offset of <code>5m</code>, which means the image will expire 5 minutes after being tagged as <code>2.0</code> and <code>latest</code>.</p>
</li>
</ul>
</div>
<div class="listingblock lines_space console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "LABEL org.opencontainers.image.authors=<a href="mailto:angel@olleb.com">angel@olleb.com</a>" &gt;&gt; Containerfile.exp
echo "LABEL quay.expires-after=5m" &gt;&gt; Containerfile.exp
podman build . -t exp:2.0 -f Containerfile.exp

podman tag localhost/exp:2.0 ${QUAY_HOSTNAME}/olleb/expiration:2.0
podman push ${QUAY_HOSTNAME}/olleb/expiration:2.0

podman tag localhost/exp:2.0 ${QUAY_HOSTNAME}/olleb/expiration:latest
podman push ${QUAY_HOSTNAME}/olleb/expiration:latest</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>At this point, the <code>olleb/expiration</code> repository contains two images and three tags:</p>
<div class="ulist">
<ul>
<li>
<p>The <code>1.0</code> image has the <code>1.0</code> tag.</p>
</li>
<li>
<p>The <code>2.0</code> image has the <code>2.0</code> and <code>latest</code> tags.
The <code>2.0</code> and <code>latest</code> tags are marked as expiring soon.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/exp1.png" alt="exp1">
</div>
</div>
<div class="paragraph">
<p>After 5 minutes, both tags will be automatically removed from the repository.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/exp2.png" alt="exp2">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/taghistoryautodeleted.png" alt="taghistoryautodeleted">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To manually configure an expiration time, select the <code>1.0</code> tag.
From the <strong>Actions</strong> drop-down list, select <strong>Change Expiration</strong>, and set the desired <strong>Expiration Date</strong>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/exp3.png" alt="exp3">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/expirationdatetag.png" alt="expirationdatetag">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Alternatively, you can set the expiration by clicking the <strong>Options</strong> icon and selecting <strong>Change Expiration</strong>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a tag is about to expire, a warning message is displayed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/abouttoexpire.png" alt="abouttoexpire">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, the minimum expiration time is <strong>one hour</strong>, and the maximum is <strong>104 weeks</strong> (approximately two years).
If you need shorter or longer expiration limits, modify the <code>LABELED_EXPIRATION_MINIMUM</code> setting in the <strong>Config Bundle Secret</strong> of your registry instance.
This property accepts values such as <code>60s</code> (seconds), <code>5m</code> (minutes), <code>24h</code> (hours), <code>7d</code> (days), or <code>2w</code> (weeks).
For more details, see <a href="quay-oci.html#allowed" class="xref page">2.5.1 Configuring allowed OCI artifact types</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When a tag expires, it is deleted automatically.</p>
</div>
<div class="paragraph">
<p>However, even after a tag is deleted, the corresponding image can still be restored.
When a tag is deleted and no other tags reference the same image, the image is not immediately removed — it is marked for <strong>garbage collection</strong>, which by default occurs after <strong>14 days (<code>2w</code>)</strong>.
Quay’s garbage collection worker runs periodically and removes expired images once the configured <strong>Time Machine</strong> retention period has passed.</p>
</div>
<div class="paragraph">
<p>Because the image was stored under the <code>olleb</code> organization, you can check that value by navigating to <code>/organization/olleb?tab=settings</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/orgexptime.png" alt="orgexptime">
</div>
</div>
<div class="paragraph">
<p>If the image was stored under a user account instead of an organization, the setting can be found under <strong>User Settings</strong>.</p>
</div>
<div class="paragraph">
<p>The <strong>Time Machine</strong> retention period can be modified by changing the <code>TAG_EXPIRATION_OPTIONS</code> array property, which must include the default expiration value <code>DEFAULT_TAG_EXPIRATION</code> in its list.
An example of how to modify this value is provided in section <a href="quay-oci.html#allowed" class="xref page">2.5.1 Configuring allowed OCI artifact types</a>.</p>
</div>
<div class="paragraph">
<p>For example, with the following custom configuration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/expcfg.png" alt="expcfg">
</div>
</div>
<div class="paragraph">
<p>you will see:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/repositories/customtm.png" alt="customtm">
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="quay-orgs.html">Users and Organizations</a></span>
  <span class="next"><a href="quay-mirror.html">Repository Mirroring</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="./_/js/vendor/clipboard.js"></script>
<script src="./_/js/site.js"></script>
<script async src="./_/js/vendor/highlight.js"></script>
  </body>
</html>
